<div *ngIf="isLoading" class="loading-overlay">
  <div class="spinner"></div>
</div>
<div *ngIf="!isLoading" class="cart_container">
  <div [class]="'header__cart'" nz-row>
    <div nz-col nzSpan="8" (click)="handleBackProductSale()">
      <span class="tag__back" nz-icon nzType="left" nzTheme="outline"></span>
    </div>
    <div class="tag__title" nz-col nzSpan="8">
      <p class="">Giỏ hàng</p>
    </div>
    <div class="tag__delete" nz-col nzSpan="8">
      <p *ngIf="listCard[0]?.cartItemResponseSet.length > 0" (click)="handleOpenModalDeleteAll(listCard[0]?.id)">
        Xóa tất cả
      </p>
      <app-modal-delete-all [isVisible]="isVisibleDeleteAll" (closeModal)="handleCloseModalDeleteAll()"
        (getCart)="handleGetCart()" [idCart]="idCartDelete"></app-modal-delete-all>
    </div>
  </div>
  <div>
    <div style="height: 11.3vw;"></div>
    <div class="warning" *ngIf="listCard[0].cartItemResponseSet.length == 0">
      <span nz-icon nzType="warning" nzTheme="outline"></span>
      <p>Không có sản phẩm nào!</p> </div>
    <div >
      <app-card-cart [listCard]="listCard" (onClickDeleteSingle)="handleOpenModalDeleteSingle($event)"
        (totalPriceChanged)="handleTotalPriceChanged($event)" (getCart)="handleGetCart()"></app-card-cart>
    </div>

    <div class="div__below"></div>
  </div>

  <app-modal-delete-single [isVisible]="isVisibleDeleteSingle" (closeModal)="handleCloseModalDeleteSingle()"
    (getCart)="handleGetCart()" [cartItem]="itemCartItem"></app-modal-delete-single>

  <div class="footer__cart">
    <div nz-row class="footer_customer">
      <div nz-col nzSpan="3" class="customer_img">
        <img nz-image width="80%" 
          nzSrc="https://cdn.sforum.vn/sforum/wp-content/uploads/2023/10/avatar-trang-4.jpg"
          nzDisablePreview="true" />
      </div>
      <div nz-col nzSpan="13" class="customer_info" *ngIf="listCustomer != null;" style="display: flex; justify-content: center;">
        <p>{{ listCustomer[0]?.customerResponse?.nameCustomer }}</p>
        <span class="info_phone">
          {{ listCustomer[0]?.customerResponse?.phoneCustomer }}
        </span>
        <span class="info_address">
          {{ listCustomer[0]?.customerResponse?.address }}
        </span>
        <p class="click_customer" *ngIf="listCard[0]?.customerResponse == null">Chọn khách hàng</p>
      </div>

      <div nz-col nzSpan ="8" class="customer_click">
        <button (click)="handleOpenModelCustomer()" style="width: 27vw;">
          <ng-container *ngIf="listCard[0]?.customerResponse != null; else selectCustomer">
            Thay đổi
          </ng-container>
          <ng-template #selectCustomer>
            Chọn
          </ng-template>
        </button>
      </div>
    </div>
    <div nz-row class="below_price">
      <div nz-col nzSpan="16">
        <div class="shipPrice">
          <span class="shipPrice_text">Phí ship: </span>
          <span class="shipPrice_number"> 50,000</span>
        </div>
        <div class="totalPrice">
          <span class="totalPrice_text">Tổng tạm tính:</span>
          <span class="totalPrice_number">{{ (addOrder.totalPrice + 0) | number }}</span>
        </div>
      </div>
      <div nz-col nzSpan="8" class="customer_submit">
        <button nz-button class="btn_submit" nzType="primary"
          [disabled]="!(listCard[0]?.cartItemResponseSet.length > 0 && listCustomer[0]?.customerResponse?.length !== null)"
          (click)="handleOpenModelAddOrder()">
          Tạo đơn
        </button>
        <app-modal-add-order [isVisible]="isVisibleAddOrder" (getProductSale)="handleBackProductSale()" (closeModal)="handleCloseModelAddOrder()"
          (getCart)="handleGetCart()" [idCart]="idCartOrder" [orderRequest]="addOrder"></app-modal-add-order>
          <app-modal-customer [isVisibleModalAddCustomer]="isVisibleModalCustomer" [idCart]="idCartCustomer" (closeModal)="handleCloseModelCustomer()">
          </app-modal-customer>
      </div>
    </div>
  </div>
</div>
